[
	{
		"type": "LibraryModule",
		"name": "Library_AimmsXLLibrary",
		"Interface": "PublicSection",
		"Comment": "\"This library allows you to read from and write to .xlsx or .xls (Excel) files.\n\t\t\n\t\tThe library does not need Excel to be installed on the machine and works both in Windows and Linux.\n\t\t\n\t\tThe library can only read and write the file formats .xlsx and .xls, but is not capable of \n\t\tevaluating any formula or macro that is contained in it. For that you need Excel itself.\n\t\t\n\t\tThe functions in this library do not use a return value to indicate success or failure.\n\t\tInstead, the functions are created to be used in combination with the error handling mechanisms in AIMMS.\n\t\tThat is why it is highly recommended to place all function calls within a :any:`block-onerror-endblock <block>` context,\n\t\tso that you can easily handle the warnings and errors that might occur during the usage of these\n\t\tfunctions.\n\t\t\n\t\tA typical usage looks like:\n\t\t\n\t\t  .. code::\n\t\t\n\t\t    block\n\t\n\t\t\t  axll::OpenWorkbook(mybook.xlsx);\n\t\t  \n\t\t\t  ! .. read or write the sheets in the workbook ..\n\t\t  \n\t\t    onerror err do\n\t\t  \n\t\t\t  ! .. handle the error or warning ..\n\t\t  \n\t\t\t  errh::MarkAsHandled(err);\n\t\t  \n\t\t    endblock;\n\t\t  \n\t\t    axll::CloseAllWorkbooks;  ! save and close any open workbook\"",
		"child": [
			{
				"type": "Section",
				"name": "PrivateSection",
				"child": [
					{
						"type": "Function",
						"name": "LibraryDirectory",
						"Range": "string",
						"Body": "if DirectoryOfLibraryProject(libraryName, LibraryDirectory) <> 1 then\n\t\t\t\t\tLibraryDirectory := libraryName;\n\t\t\t\tendif;",
						"child": [
							{
								"type": "StringParameter",
								"name": "libraryName",
								"child": []
							}
						]
					},
					{
						"type": "Function",
						"name": "DLLDirectory",
						"Range": "string",
						"Body": "DLLDirectory := LibraryDirectory(libraryName) +\"DLL\" + if (AimmsStringConstants('Platform') = \"Windows\") then \"\\\\\" else \"/\" endif;",
						"child": [
							{
								"type": "StringParameter",
								"name": "libraryName",
								"child": []
							}
						]
					},
					{
						"type": "Function",
						"name": "DLLPath",
						"Range": "string",
						"Body": "DLLPath := DLLDirectory(libraryName) + dllName + if (AimmsStringConstants('Platform') = \"Windows\") then \".dll\" else \".so\" endif;",
						"child": [
							{
								"type": "StringParameter",
								"name": "libraryName",
								"child": []
							},
							{
								"type": "StringParameter",
								"name": "dllName",
								"child": []
							}
						]
					},
					{
						"type": "Procedure",
						"name": "PreLibraryTermination",
						"Body": "::Library_AimmsXLLibrary::closeAllWorkBooks;\n\t\t\t\treturn 1;",
						"child": []
					},
					{
						"type": "Section",
						"name": "CommonDeclarations",
						"child": [
							{
								"type": "ElementParameter",
								"name": "STR_ENCODING",
								"Property": "NoSave",
								"Definition": "if AimmsStringConstants('Platform') = \"Windows\" then\n\t\t\t\t\t\t'UTF-16LE'\n\t\t\t\t\telse\n\t\t\t\t\t\t'UTF-32LE'\n\t\t\t\t\tendif",
								"child": []
							},
							{
								"type": "StringParameter",
								"name": "DLL_NAME",
								"child": []
							}
						]
					}
				]
			}
		]
	}
]
